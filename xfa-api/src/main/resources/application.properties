# Configura��es do servidor
quarkus.http.port=8085
quarkus.http.host=0.0.0.0

# Configura��es do OpenAPI/Swagger
quarkus.smallrye-openapi.path=/swagger
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.path=/swagger-ui

# ================================
# Configura��es de CORS
# ================================
quarkus.http.cors.enabled=true
quarkus.http.cors.methods=GET,PUT,POST,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with

# Desenvolvimento: libera tudo
%dev.quarkus.http.cors.origins=*

# Produ��o: libera apenas o frontend real
%prod.quarkus.http.cors.origins=*

#Testando o acesso com o CORS ativo
#curl -i -X OPTIONS http://localhost:8081/api/products -H "Origin: http://localhost:8080"   -H "Access-Control-Request-Method: GET"



# Configura��es de log
quarkus.log.console.enable=true
quarkus.log.console.level=INFO
quarkus.log.category."com.xfinder.api.produtos".level=DEBUG
quarkus.log.category."com.xfinder.superfrete".level=DEBUG
quarkus.log.category."com.xfinder.api.auth".level=DEBUG

# Banner customizado
quarkus.banner.enabled=true

# Configura��es da API Superfrete
superfrete.api.token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTk0MDMyNjYsInN1YiI6IktsQnlIY0ZhRWJSZWE5anJyS1lxM25KQWV4SjMifQ.x4pHsm3Z6-kP4TLcej8p2pC_OxW50cKDfDtl006cRmg
superfrete.store.postal-code=03167030
superfrete.store.email=contato.xfinder@gmail.com.br

# Configura��o do Rest Client
#superfrete.com.xfinder.api.SuperfreteApiClient/mp-rest/url=https://sandbox.superfrete.com
quarkus.rest-client."superfrete-api".url=https://sandbox.superfrete.com
#superfrete.com.xfinder.api.SuperfreteApiClient/mp-rest/scope=jakarta.inject.Singleton
quarkus.rest-client."superfrete-api".scope=jakarta.inject.Singleton

# Configuração do Mailer para Gmail
# Usando porta 465 com SSL direto (mais confiável que STARTTLS na porta 587)
quarkus.mailer.from=contato.xfinder@gmail.com
quarkus.mailer.host=smtp.gmail.com
quarkus.mailer.port=465
quarkus.mailer.ssl=true
quarkus.mailer.start-tls=DISABLED
quarkus.mailer.username=contato.xfinder@gmail.com
quarkus.mailer.password=bpir kvyk osew qxkz
quarkus.mailer.auth-methods=PLAIN LOGIN
quarkus.mailer.mock=false
# Trust all certificates (apenas para desenvolvimento - em produção usar certificados válidos)
quarkus.mailer.trust-all=true

#quarkus.mailer.username=fctassinari@gmail.com
#quarkus.mailer.password=xkkk crlq ifnb pbpj


# Database configuration
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=postgres
quarkus.datasource.password=XFA@2025
quarkus.datasource.jdbc.url=jdbc:postgresql://xfinder-postgres:5432/xfa
#quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/xfa

# Hibernate configuration
quarkus.hibernate-orm.database.generation=update
quarkus.hibernate-orm.log.sql=true

# ================================
# Configurações do Keycloak / OIDC
# ================================
# URL do servidor de autenticação Keycloak
#quarkus.oidc.auth-server-url=https://localhost:8443/realms/xfinder
quarkus.oidc.auth-server-url=https://xfinder-archery.com.br/realms/xfinder

# Client ID configurado no Keycloak
quarkus.oidc.client-id=xfinder-web

# Para client público, não é necessário secret
# quarkus.oidc.credentials.secret=your-secret-here

# Verificar token em cada requisição
quarkus.oidc.token.verify-access-token-with-verification-key=true

# Permitir acesso anônimo a alguns endpoints (será controlado por @RolesAllowed)
quarkus.oidc.tenant-enabled=true

# Configuração de roles
# IMPORTANTE: Baseado no projeto angular-quarkus que funciona
# O mapper no Keycloak deve adicionar roles no claim 'roles' (não aninhado)
# Se usar realm_access.roles, o Quarkus pode não extrair corretamente
quarkus.oidc.roles.role-claim-path=roles
# Fonte das roles: accesstoken (do token JWT)
quarkus.oidc.roles.source=accesstoken
# Habilitar logs de debug para troubleshooting
quarkus.log.category."io.quarkus.oidc".level=DEBUG
quarkus.log.category."io.quarkus.security".level=DEBUG

# Tempo de expiração do token (em segundos)
quarkus.oidc.token.lifespan-grace=60

# ================================
# Configurações SSL para Desenvolvimento
# ================================
# Desabilitar validação de certificados SSL em desenvolvimento (apenas para certificados auto-assinados)
# ATENÇÃO: NÃO use isso em produção! Use apenas em desenvolvimento local!
# Isso permite que o Quarkus se conecte ao Keycloak com certificado auto-assinado
%dev.quarkus.tls.trust-all=true
# Configurar OIDC para não verificar certificados SSL em desenvolvimento
%dev.quarkus.oidc.tls.verification=none
# Configurar OIDC Client para não verificar certificados SSL
%dev.quarkus.oidc-client.tls.verification=none
# Configurar Rest Client para não verificar certificados SSL (se necessário)
%dev.quarkus.rest-client."superfrete-api".trust-all=true

